SELECT DISTINCT TMOV.CODCOLIGADA           AS 'COLIGADA',
                CASE TMOV.CODFILIAL
                  WHEN '1' THEN 'DF'
                  WHEN '2' THEN 'BR - RS'
                  WHEN '3' THEN 'RN'
                  WHEN '4' THEN 'PB'
                  WHEN '5' THEN 'GO'
                  
                END                        AS 'FILIAL',
                TMOV.IDMOV                 AS 'ID - MOV',
                TMOV.CODTMV                AS 'CODTMV',
                TMOV.DATAEMISSAO           AS 'DATA DE EMISÃO',
                TMOV.DATAEXTRA1            AS 'DATA DE RECEBIMENTO',
                GCCUSTO.NOME               AS 'CENTRO DE CUSTO',
                CASE
                  WHEN TLOC.NOME = 'ALMOXARIFADO CENT. JOAO PESSOA GENNESIS' THEN 'ALMOXARIFADO CENTRAL JOAO PESSOA'
                  ELSE TLOC.NOME
                END                        AS 'LOCAL DE ESTOQUE',
                TPRODUTO.CODIGOPRD         AS 'CÓDIGO DO PRODUTO',
                FCFO.NOMEFANTASIA          AS 'FORNECEDOR',
                TITMMOV.CODUND             AS 'UNIDADE',
                TPRODUTO.NOMEFANTASIA      AS 'NOME DO PRODUTO',
                TTB1.DESCRICAO             AS 'DISCIPLINA',
                TITMMOV.PRECOUNITARIO      AS 'CUSTO UNITÁRIO',
                TITMMOV.QUANTIDADEORIGINAL AS 'QUANTIDADE',
                TMOV.USUARIOCRIACAO        AS 'USUARIO',
                RELACITEMOC.IDMOVORIGEM    AS 'IDMOV OC'
FROM   TMOV
       LEFT JOIN TTMV
              ON TMOV.CODTMV = TTMV.CODTMV
                 AND TMOV.CODCOLIGADA = TTMV.CODCOLIGADA
       LEFT JOIN TMOVATEND
              ON TMOV.IDMOV = TMOVATEND.IDMOV
                 AND TMOV.CODCOLIGADA = TMOVATEND.CODCOLIGADA
       LEFT JOIN HATENDIMENTOEXT
              ON TMOVATEND.CODATENDIMENTO = HATENDIMENTOEXT.CODATENDIMENTO
                 AND TMOVATEND.CODLOCAL = HATENDIMENTOEXT.CODLOCAL
       LEFT JOIN GCCUSTO
              ON TMOV.CODCCUSTO = GCCUSTO.CODCCUSTO
                 AND TMOV.CODCOLIGADA = GCCUSTO.CODCOLIGADA
       LEFT JOIN TLOC
              ON TMOV.CODLOC = TLOC.CODLOC
                 AND TMOV.CODCOLIGADA = TLOC.CODCOLIGADA
                 AND TMOV.CODFILIAL = TLOC.CODFILIAL
       LEFT JOIN TITMMOV
              ON TMOV.CODCOLIGADA = TITMMOV.CODCOLIGADA
                 AND TMOV.IDMOV = TITMMOV.IDMOV
       INNER JOIN TITMMOVRELAC RELACITEMOC (NOLOCK)
               ON TITMMOV.IDMOV = RELACITEMOC.IDMOVDESTINO
                  AND TITMMOV.CODCOLIGADA = RELACITEMOC.CODCOLDESTINO
                  AND TITMMOV.NSEQITMMOV = RELACITEMOC.NSEQITMMOVDESTINO
       LEFT JOIN TPRODUTO
              ON TPRODUTO.IDPRD = TITMMOV.IDPRD
       LEFT JOIN TPRODUTODEF (NOLOCK)
              ON TPRODUTO.IDPRD = TPRODUTODEF.IDPRD
       LEFT JOIN TTB1 (NOLOCK)
              ON TTB1.CODTB1FAT = TPRODUTODEF.CODTB1FAT
                 AND TPRODUTODEF.CODCOLIGADA = TTB1.CODCOLIGADA
       LEFT JOIN FCFO
              ON FCFO.CODCFO = TMOV.CODCFO
WHERE  TMOV.CODTMV IN ( '4.1.00', '4.1.01', '1.2.01', '1.2.06',
                        '1.2.07', '3.1.01', '3.1.02', '3.2.01', '1.2.05' )
       AND TMOV.CODCOLIGADA = '1'
       AND TMOV.DATAEMISSAO > '2024-01-01'
       AND TMOV.DATAEXTRA1  > '2024-01-01'
       AND TMOV.SERIE NOT IN ('AJS')
       AND TMOV.STATUS NOT IN ('C')
